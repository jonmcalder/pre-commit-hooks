<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pre-Commit Hooks • precommit</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><!-- docsearch --><script src="docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Pre-Commit Hooks">
<meta property="og:description" content="Useful git hooks for R building on top of the
    multi-language framework pre-commit for hook management. This
    package provides git hooks for common tasks like formatting files with
    styler or spell checking as well as wrapper functions to access the
    pre-commit executable.">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">precommit</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.1.3.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/why-use-hooks.html">Why hooks?</a>
    </li>
    <li>
      <a href="articles/available-hooks.html">Available hooks</a>
    </li>
    <li>
      <a href="articles/FAQ.html">FAQ</a>
    </li>
  </ul>
</li>
<li>
  <a href="news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/lorenzwalthert/precommit/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">
<div id="useful-git-pre-commit-hooks-for-r" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#useful-git-pre-commit-hooks-for-r" class="anchor"></a>Useful git pre-commit hooks for R</h1></div>
<!-- badges: start -->

<p><a href="https://pre-commit.com">Pre-commit hooks</a> are tests that run each time you attempt to commit. If the tests pass, the commit will be made, otherwise not. A very basic test is to check if the code is parsable, making sure you have not forgotten a comma, brace or quote.</p>
<p>The goal of this package is to twofold:</p>
<ul>
<li><p>Provide a <a href="https://lorenzwalthert.github.io/precommit/articles/available-hooks.html">set of hooks</a> that are useful when your git repo contains R code.</p></li>
<li><p>Provide <a href="https://github.com/r-lib/usethis">usethis</a>-like functionality for common tasks such as installation and set-up and config file modification.</p></li>
</ul>
<p>The following online docs are available:</p>
<ul>
<li><p><a href="https://lorenzwalthert.github.io/precommit/">latest CRAN release</a>.</p></li>
<li><p><a href="https://lorenzwalthert.github.io/precommit/dev/">GitHub development version</a>.</p></li>
</ul>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>You can install the package from CRAN:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span><span class="op">(</span><span class="st">"precommit"</span><span class="op">)</span></code></pre></div>
<p>To access pre-commit functionality from R, you also need to install the <a href="https://pre-commit.com">pre-commit framework</a>. The following command line methods are tested to work with this R package (and accessing them from outside R is easier and use is slightly faster):</p>
<ul>
<li><p><code>$ pip3 install pre-commit --user</code> (macOS, Linux and Windows) <strong>outside</strong> a conda or virtual environment.</p></li>
<li><p><code>$ brew install pre-commit</code> (macOS).</p></li>
</ul>
<p>Alternatively, you can handle the installation from R using <a href="https://docs.conda.io/en/latest/miniconda.html">miniconda</a>:</p>
<ul>
<li><p>install miniconda if you don’t have it already: <code><a href="https://rdrr.io/pkg/reticulate/man/install_miniconda.html">reticulate::install_miniconda()</a></code>. This needs reticulate &gt;= 1.14.</p></li>
<li><p>install the pre-commit framework with <code><a href="reference/install_precommit.html">precommit::install_precommit()</a></code> into the conda environment <code>r-precommit</code>. Do not install other packages into this environment.</p></li>
</ul>
<p>Then, in a fresh R session:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># once in every git repo either</span>
<span class="co"># * after cloning a repo that already uses pre-commit or</span>
<span class="co"># * if you want introduce pre-commit to this repo</span>
<span class="fu">precommit</span><span class="fu">::</span><span class="fu"><a href="reference/use_precommit.html">use_precommit</a></span><span class="op">(</span><span class="op">)</span></code></pre></div>
<p>The last command initializes pre-commit in your repo and performs some set-up tasks like creating the config file <code>.pre-commit-config.yaml</code>, where the hooks that will be run on <code>git commit</code> are specified. See <code>?precommit::use_precommit()</code> to see how you can use a custom <code>.pre-commit-config.yaml</code> instead of the default at initialization. You can (obviously) change edit the file manually at any time.</p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The next time you run <code>git commit</code>, the hooks listed in your <code>.pre-commit-config.yaml</code> will get executed before the commit. The helper function <code><a href="reference/open_config.html">precommit::open_config()</a></code> let’s you open and edit the <code>.pre-commit-config.yaml</code> conveniently from the RStudio console. When any file is changed due to running a hook or the hook script errors, the commit will fail. You can inspect the changes introduced by the hook and if satisfied, you can add the changes made by the hook to the index with <code>git add path/to/file</code> and attempt to commit again. Some hooks change files, like the styler hook, so all you need to do to make the hook pass is <code>git add</code> the changes introduced by the hook. Other hooks, like the parsable-R hook, will need your action, e.g. add a missing closing brace to a call like <code>library(styler</code>, before they pass at the next attempt. If all hooks pass, the commit is made. You can also <a href="https://pre-commit.com/#temporarily-disabling-hooks">temporarily disable hooks</a>. If you succeed, it should look like this:</p>
<p><img src="reference/figures/screenshot.png" width="639"></p>
<p>See the hooks provided by this repo under <code><a href="articles/available-hooks.html">vignette("available-hooks")</a></code>. You can also add other hooks from other repos, by extending the <code>.pre-commit-config.yaml</code> file, e.g. like this:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode yaml"><code class="sourceCode yaml"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw">-</span><span class="at">   </span><span class="fu">repo</span><span class="kw">:</span><span class="at"> https://github.com/pre-commit/precommit</span></span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="at">    </span><span class="fu">rev</span><span class="kw">:</span><span class="at"> v1.2.3</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="at">    </span><span class="fu">hooks</span><span class="kw">:</span><span class="at"> </span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="at">    </span><span class="kw">-</span><span class="at">   </span><span class="fu">id</span><span class="kw">:</span><span class="at"> check-added-large-files</span></span></code></pre></div>
<p>To update the hook revisions, run <code><a href="reference/autoupdate.html">precommit::autoupdate()</a></code>.</p>
</div>
<div id="caution" class="section level2">
<h2 class="hasAnchor">
<a href="#caution" class="anchor"></a>Caution</h2>
<ul>
<li><p><strong>Do not abort while hooks are running in RStudio git tab.</strong> Non-staged changes are stashed to a temp directory and when you abort in RStudio, these changes are not brought back to you repo. Upvote <a href="https://github.com/rstudio/rstudio/issues/6471">this issue</a> to change this. We hope that in the future, the changes will be recovered in RStudio too. Note that this is only an issue with RStudio. Stashes are restored when you abort a <code>git   commit</code> with <code>INT</code> (e.g. Ctrl+C) on the command line. To restore stashes, manually after hitting <em>abort</em> in the RStudio git tab, you can <code>git   apply /path/to/patch_with_id</code> whereas you find the patch under your pre-commit cache, which is usually under <code>$HOME/.cache/pre-commit/</code>.</p></li>
<li><p>Because R is not officially supported as a language in the pre-commit framework (yet), there is no R package dependency management for the R hooks provided in this repo. If an R package that is needed by a hook is not yet installed, you might get this error:</p></li>
</ul>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># &gt; Error in loadNamespace(name) : there is no package called ‘__name_of_package__’</span></code></pre></div>
<p>In that case, just install the package with <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages()</a></code> once and try to commit again. All R dependencies of the pre-commit hooks provided in this repo are suggested dependencies of this R package, so if you want to install them all, just <code><a href="https://rdrr.io/r/utils/install.packages.html">install.packages("precommit", dependencies = c("Imports", "Suggests"))</a></code>.</p>
</div>
<div id="documentation" class="section level2">
<h2 class="hasAnchor">
<a href="#documentation" class="anchor"></a>Documentation</h2>
<p>The <a href="https://lorenzwalthert.github.io/precommit/index.html">online documentation</a> of this package only covers the functionality added on top of pre-commit by this package. Everything else is covered in the extensive <a href="https://pre-commit.com">online documentation</a> of the pre-commit framework itself, including how to:</p>
<ul>
<li><p>create pre-push hooks</p></li>
<li><p>create local hooks</p></li>
<li><p>and more</p></li>
</ul>
</div>
<div id="update" class="section level2">
<h2 class="hasAnchor">
<a href="#update" class="anchor"></a>Update</h2>
<p>To update the pre-commit executable, use the update utilities provided by your installation method. If you chose conda, you can use <code><a href="reference/update_precommit.html">precommit::update_precommit()</a></code>.</p>
<p>You can check the version of you executable with <code><a href="reference/version_precommit.html">precommit::version_precommit()</a></code>.</p>
</div>
<div id="uninstallation" class="section level2">
<h2 class="hasAnchor">
<a href="#uninstallation" class="anchor"></a>Uninstallation</h2>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/uninstall_precommit.html">uninstall_precommit</a></span><span class="op">(</span><span class="st">"repo"</span><span class="op">)</span> <span class="co"># just for the repo you are in.</span>
<span class="fu"><a href="reference/uninstall_precommit.html">uninstall_precommit</a></span><span class="op">(</span><span class="st">"user"</span><span class="op">)</span> <span class="co"># remove the pre-commit conda executable.</span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=precommit">https://​cloud.r-project.org/​package=precommit</a>
</li>
<li>Browse source code at <br><a href="https://github.com/lorenzwalthert/precommit/">https://​github.com/​lorenzwalthert/​precommit/​</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></small></li>
</ul>
</div>
<div class="community">
<h2>Community</h2>
<ul class="list-unstyled">
<li><a href="CONTRIBUTING.html">Contributing guide</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>
<a href="http://lorenzwalthert.netlify.com">Lorenz Walthert</a> <br><small class="roles"> Maintainer </small>  </li>
</ul>
</div>

  <div class="dev-status">
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="https://CRAN.R-project.org/package=precommit"><img src="https://www.r-pkg.org/badges/version/precommit" alt="CRAN status"></a></li>
<li><a href="https://www.tidyverse.org/lifecycle/#experimental"><img src="https://img.shields.io/badge/lifecycle-experimental-orange.svg" alt="Lifecycle: experimental"></a></li>
<li><a href="https://github.com/lorenzwalthert/precommit/actions"><img src="https://github.com/lorenzwalthert/precommit/workflows/R-CMD-check/badge.svg" alt="R build status"></a></li>
</ul>
</div>
</div>
</div>


      <footer><div class="copyright">
  <p>Developed by <a href="http://lorenzwalthert.netlify.com">Lorenz Walthert</a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'ae5363c86f48f4117b4f2b9beaefa28f',
    indexName: 'lorenzwalthert_precommit',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
